<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kopfrechnen ‚Äì Little Professor Style</title>
<meta name="description" content="Kindgerechte Kopfrechen-App, 20 Aufgaben, Timer, Schwierigkeitsstufen, Fortschrittsanzeige, Feedback, Animationen, DSGVO-konform." />
<style>
:root {
  --bg: #E0F7FA;
  --card: #FFFFFF;
  --accent: #FFB74D;
  --ok: #43A047;
  --err: #E53935;
  --text: #0D47A1;
  --muted: #6b7280;
  font-family: 'Comic Sans MS', cursive, sans-serif;
}
* { box-sizing: border-box; }
body { margin: 0; background: var(--bg); color: var(--text); display: flex; justify-content: center; padding: 24px; }
.container { max-width: 900px; width: 100%; }
header { text-align: center; margin-bottom: 24px; }
h1 { font-size: 2.2rem; margin-bottom: 6px; color: var(--text); }
.subtitle { font-size: 1.1rem; color: var(--muted); margin-bottom: 6px; }
.version { font-size: 0.9rem; color: var(--muted); }
.card { background: var(--card); border-radius: 16px; box-shadow: 0 8px 20px rgba(0,0,0,0.08); padding: 24px; transition: transform 0.2s; }
.card.bounce { animation: bounce 0.5s; }
@keyframes bounce { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
.controls { display: flex; flex-wrap: wrap; gap: 16px; justify-content: center; margin-bottom: 20px; }
select, button { padding: 16px 24px; border-radius: 12px; border: none; font-size: 1.1rem; cursor: pointer; }
select { background: #fff; }
button.primary { background: var(--accent); color: #fff; transition: 0.2s; }
button.primary:hover { background: #fb8c00; }
button.secondary { background: #B3E5FC; color: var(--text); }
.exercise { text-align: center; margin-top: 16px; }
.taskline { font-size: 1.3rem; margin-bottom: 8px; }
.task { font-size: 3rem; font-weight: bold; color: var(--text); margin-bottom: 12px; transition: 0.3s; }
input[type=number] { padding: 16px 20px; border-radius: 12px; border: 2px solid #90CAF9; font-size: 2rem; width: 150px; text-align: center; }
.feedback { font-size: 1.8rem; font-weight: bold; margin-top: 12px; min-height: 40px; transition: 0.3s; }
.feedback.ok { color: var(--ok); animation: blinkgreen 0.5s; }
.feedback.err { color: var(--err); animation: blinkred 0.5s; }
@keyframes blinkgreen { 0% {opacity:0;} 50% {opacity:1;} 100% {opacity:1;} }
@keyframes blinkred { 0% {opacity:0;} 50% {opacity:1;} 100% {opacity:1;} }
.summary { display: flex; gap: 20px; align-items: center; justify-content: center; flex-wrap: wrap; margin-top: 24px; }
canvas { background: #fff; border-radius: 12px; padding: 8px; }
.timer-bar { width: 100%; height: 24px; background: #B3E5FC; border-radius: 12px; margin-bottom: 12px; overflow: hidden; }
.timer-fill { height: 100%; width: 100%; background: var(--accent); transition: width 1s linear; }
footer { margin-top: 20px; font-size: 0.9rem; color: var(--muted); text-align: center; }
@media (max-width: 640px) { input[type=number] { width: 100%; } .controls { flex-direction: column; align-items: center; } }
</style>
</head>
<body>
<main class="container">
<header>
<h1>Kopfrechnen ‚Äì Little Professor</h1>
<div class="subtitle">W√§hle Rechenart, Schwierigkeitsstufe & Timer, l√∂se 20 Aufgaben!</div>
<div class="version">Version 1.3</div>
</header>
<section class="card" id="card">
<div class="controls">
<select id="op" aria-label="Rechenart w√§hlen">
<option value="all">Alles ‚ûï‚ûñ‚úñÔ∏è‚ûó</option>
<option value="+">Addition (+)</option>
<option value="-">Subtraktion (-)</option>
<option value="*">Multiplikation (√ó)</option>
<option value="/">Division (√∑)</option>
</select>
<select id="level" aria-label="Schwierigkeitsstufe w√§hlen">
<option value="1">Stufe 1</option>
<option value="2">Stufe 2</option>
<option value="3">Stufe 3</option>
<option value="4">Stufe 4</option>
<option value="5">Stufe 5</option>
</select>
<select id="timer" aria-label="Timer w√§hlen">
<option value="0">Kein Timer</option>
<option value="120">2 Minuten</option>
<option value="300">5 Minuten</option>
<option value="600">10 Minuten</option>
</select>
<button id="startBtn" class="primary">Start</button>
<button id="restartBtn" class="secondary">Neu</button>
</div>
<div class="timer-bar" style="display:none;"><div id="timerFill" class="timer-fill"></div></div>
<div id="exercise" class="exercise" aria-live="polite"></div>
<div id="summaryArea"></div>
<footer>Alles l√§uft lokal im Browser ‚Äì DSGVO-freundlich.</footer>
</section>
</main>
<script>
const TOTAL=20;
let tasks=[],current=0,correctCount=0,timerId=null,timeLeft=0;
const opEl=document.getElementById('op');
const levelEl=document.getElementById('level');
const timerEl=document.getElementById('timer');
const startBtn=document.getElementById('startBtn');
const restartBtn=document.getElementById('restartBtn');
const exerciseEl=document.getElementById('exercise');
const summaryArea=document.getElementById('summaryArea');
const timerBar=document.querySelector('.timer-bar');
const timerFill=document.getElementById('timerFill');
const cardEl=document.getElementById('card');
function randInt(n){return Math.floor(Math.random()*n);}

function makeTask(level, opChoice){
    let maxRange, maxMul;
    switch(level){
        case '1': maxRange=20; maxMul=5; break;
        case '2': maxRange=50; maxMul=10; break;
        case '3': maxRange=100; maxMul=15; break;
        case '4': maxRange=500; maxMul=20; break;
        case '5': maxRange=1000; maxMul=50; break;
    }

    const ops=['+','-','*','/'];
    const op=opChoice==='all'?ops[randInt(ops.length)]:opChoice;
    let a,b,res;

    switch(op){
        case '+': a=randInt(maxRange+1); b=randInt(maxRange+1); res=a+b; break;
        case '-': a=randInt(maxRange+1); b=randInt(a+1); res=a-b; break;
        case '*': a=randInt(maxMul+1); b=randInt(maxMul+1); res=a*b; break;
        case '/': b=randInt(maxMul)+1; const q=randInt(maxMul)+1; a=b*q; res=q; break;
    }
    return {a,b,op,res};
}

function startTest(){
    clearInterval(timerId); tasks=[],current=0,correctCount=0; summaryArea.innerHTML='';
    const opChoice=opEl.value, levelVal=levelEl.value, timerVal=Number(timerEl.value);
    for(let i=0;i<TOTAL;i++) tasks.push(makeTask(levelVal,opChoice));
    startBtn.disabled=true; opEl.disabled=true; levelEl.disabled=true; timerEl.disabled=true;
    if(timerVal>0){timeLeft=timerVal; timerBar.style.display='block'; updateTimerBar(); timerId=setInterval(countDown,1000);} else timerBar.style.display='none';
    showTask();
}

function countDown(){timeLeft--; if(timeLeft<=0){clearInterval(timerId); showSummary();} updateTimerBar();}
function updateTimerBar(){const pct=Math.max(0,(timeLeft/Number(timerEl.value))*100); timerFill.style.width=pct+'%';}

function showTask(){if(current>=tasks.length) return showSummary(); const t=tasks[current];
exerciseEl.innerHTML=`<div class="taskline">Aufgabe ${current+1} / ${TOTAL}</div><div class="task">${t.a} ${t.op} ${t.b} =</div><div style="display:flex;gap:16px;justify-content:center;align-items:center"><input id="answer" type="number" inputmode="numeric" aria-label="Antwort eingeben" /><button id="okBtn" class="primary">Pr√ºfen</button></div><div id="feedback" class="feedback" role="status" aria-live="polite"></div>`;
const answerEl=document.getElementById('answer'); const okBtn=document.getElementById('okBtn'); answerEl.focus(); answerEl.addEventListener('keydown',(e)=>{if(e.key==='Enter') okBtn.click();}); okBtn.addEventListener('click',()=>checkAnswer());}

function checkAnswer(){const t=tasks[current]; const answerEl=document.getElementById('answer'); const feedbackEl=document.getElementById('feedback'); if(answerEl.value===''){feedbackEl.textContent='Bitte eine Zahl eingeben.';feedbackEl.className='feedback'; return;} let user=Math.trunc(Number(answerEl.value)); if(user===t.res){correctCount++; feedbackEl.textContent='Richtig!'; feedbackEl.className='feedback ok'; cardEl.classList.add('bounce'); setTimeout(()=>cardEl.classList.remove('bounce'),500);} else{feedbackEl.innerHTML=`Falsch. Richtig: <strong>${t.res}</strong>`; feedbackEl.className='feedback err'; cardEl.classList.add('bounce'); setTimeout(()=>cardEl.classList.remove('bounce'),500);} current++; setTimeout(showTask,700);}

function showSummary(){clearInterval(timerId); startBtn.disabled=false; opEl.disabled=false; levelEl.disabled=false; timerEl.disabled=false; const wrong=TOTAL-correctCount;
summaryArea.innerHTML=`<div class="card" style="margin-top:16px;padding:18px;text-align:center"><h3>Ergebnis</h3><div class="summary"><div><p><strong>Richtig:</strong> ${correctCount}</p><p><strong>Falsch:</strong> ${wrong}</p></div><canvas id="chart" width="300" height="180" aria-label="Ergebnisdiagramm"></canvas></div></div>`;
drawChart(correctCount, wrong); showTip(Number(levelEl.value));}

function drawChart(ok,bad){const c=document.getElementById('chart'); if(!c)return; const ctx=c.getContext('2d'); ctx.clearRect(0,0,c.width,c.height); const total=ok+bad||1; const okH=Math.round((ok/total)*120); const badH=Math.round((bad/total)*120); ctx.fillStyle='#FFFFFF'; ctx.fillRect(0,0,c.width,c.height); ctx.fillStyle='#43A047'; ctx.fillRect(40,c.height-okH-30,80,okH); ctx.fillStyle='#000'; ctx.fillText(`Richtig: ${ok}`,40,c.height-okH-35); ctx.fillStyle='#E53935'; ctx.fillRect(180,c.height-badH-30,80,badH); ctx.fillStyle='#000'; ctx.fillText(`Falsch: ${bad}`,180,c.height-badH-35); ctx.fillStyle='#6b7280'; ctx.fillText(`${ok+bad} Aufgaben`,120,c.height-8);}

function showTip(level) {
    const successRate = correctCount / TOTAL;
    let tip = '';
    if(level < 5 && successRate >= 0.8) tip = 'Super! Du kannst jetzt die n√§chste Schwierigkeitsstufe ausprobieren ‚úÖ';
    else if(level > 1 && successRate < 0.8) tip = 'Kein Problem! Versuche nochmal die Stufe darunter üîΩ';
    else if(level === 5 && successRate >= 0.8) tip = 'Gl√ºckwunsch! Du hast die h√∂chste Schwierigkeitsstufe gut gemeistert üéâ';
    else if(level === 1 && successRate < 0.8) tip = 'Keine Sorge! √úbe nochmal diese Stufe, dann bist du bald fit üëç';
    if(tip){ const tipEl=document.createElement('p'); tipEl.style.marginTop='12px'; tipEl.style.fontSize='1.2rem'; tipEl.style.color='#0D47A1'; tipEl.textContent=tip; summaryArea.appendChild(tipEl);}
}

startBtn.addEventListener('click',startTest);
restartBtn.addEventListener('click',()=>{clearInterval(timerId); tasks=[];current=0;correctCount=0;startBtn.disabled=false;opEl.disabled=false;levelEl.disabled=false;timerEl.disabled=false; exerciseEl.innerHTML='';summaryArea.innerHTML=''; timerBar.style.display='none';}); startBtn.focus();
</script>
</body>
</html>
